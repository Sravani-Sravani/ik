<%@page import="com.liferay.portal.kernel.util.HtmlUtil"%>
<%@page contentType="text/html; charset=UTF-8"%>
<html>
<head>
    <title>Email Template</title>
</head>
<body>
    <h1>Hello, <%= HtmlUtil.escape(name) %>!</h1>
    <p><%= HtmlUtil.escape(message) %></p>
    <img src="<%= HtmlUtil.escapeAttribute(imagePath) %>" alt="Image">
</body>
</html>

import com.liferay.mail.kernel.model.MailMessage;
import com.liferay.mail.kernel.service.MailServiceUtil;

public class EmailSender {

    public static void main(String[] args) {
        String toAddress = "recipient@example.com";
        String subject = "Dynamic Values in Email Body";

        // Values retrieved in Java
        String name = "John Doe";
        String message = "Thank you for your interest!";
        String imagePath = "https://example.com/image.jpg";

        // Read the content of the JSP file and evaluate it as a string
        String body = JspUtil.evaluateJspToString("path/to/your/emailTemplate.jsp");

        // Send email using MailServiceUtil (deprecated in newer versions, use MailEngine instead)
        try {
            MailMessage mailMessage = new MailMessage();
            mailMessage.setHTMLFormat(true);
            mailMessage.setBody(body);
            mailMessage.setSubject(subject);
            mailMessage.setTo(toAddress);

            MailServiceUtil.sendEmail(mailMessage);

            System.out.println("Email sent successfully!");
        } catch (Exception e) {
            System.out.println("Failed to send email: " + e.getMessage());
        }
    }
}
